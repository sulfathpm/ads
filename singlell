#include <stdio.h>
#include <stdlib.h>

struct Node {
    int data;
    struct Node *next;
};
typedef struct Node list;

list *start = NULL;

// Create a linked list with n nodes
void create() {
    int i, n, val;
    list *ptr, *t;
    printf("\nEnter number of nodes (N): ");
    scanf("%d", &n);

    for (i = 0; i < n; i++) {
        ptr = (list *)malloc(sizeof(list));
        printf("Enter data for node %d: ", i + 1);
        scanf("%d", &val);
        ptr->data = val;
        ptr->next = NULL;

        if (start == NULL) {
            start = ptr;  // first node
            t = ptr;
        } else {
            t->next = ptr;
            t = ptr;
        }
    }
    printf("Linked list created with %d nodes.\n", n);
}

// Insert at beginning
void insert_begin(int val) {
    list *ptr = (list *)malloc(sizeof(list));
    ptr->data = val;
    ptr->next = start;
    start = ptr;
    printf("Inserted %d at beginning.\n", val);
}

// Insert at end
void insert_end(int val) {
    list *ptr = (list *)malloc(sizeof(list));
    ptr->data = val;
    ptr->next = NULL;

    if (start == NULL) {
        start = ptr;
    } else {
        list *t = start;
        while (t->next != NULL)
            t = t->next;
        t->next = ptr;
    }
    printf("Inserted %d at end.\n", val);
}

// Insert at specific position
void insert_position(int val, int pos) {
    list *ptr = (list *)malloc(sizeof(list));
    ptr->data = val;
    ptr->next = NULL;

    if (pos == 1) { // insert at beginning
        ptr->next = start;
        start = ptr;
        printf("Inserted %d at position %d.\n", val, pos);
        return;
    }

    list *t = start;
    int i;
    for (i = 1; i < pos - 1 && t != NULL; i++) {
        t = t->next;
    }

    if (t == NULL) {
        printf("Invalid position %d! Cannot insert.\n", pos);
        free(ptr);
        return;
    }

    ptr->next = t->next;
    t->next = ptr;
    printf("Inserted %d at position %d.\n", val, pos);
}

// Delete from beginning
void delete_begin() {
    if (start == NULL) {
        printf("List is empty.\n");
        return;
    }
    list *t = start;
    start = start->next;
    printf("Deleted %d from beginning.\n", t->data);
    free(t);
}

// Delete from end
void delete_end() {
    if (start == NULL) {
        printf("List is empty.\n");
        return;
    }
    list *t = start, *prev = NULL;

    if (t->next == NULL) { // only one node
        printf("Deleted %d from end.\n", t->data);
        free(t);
        start = NULL;
        return;
    }

    while (t->next != NULL) {
        prev = t;
        t = t->next;
    }
    printf("Deleted %d from end.\n", t->data);
    free(t);
    prev->next = NULL;
}

// Delete from specific position
void delete_position(int pos) {
    if (start == NULL) {
        printf("List is empty.\n");
        return;
    }

    list *t = start, *prev = NULL;
    int i;

    if (pos == 1) { // delete first node
        start = start->next;
        printf("Deleted %d from position %d.\n", t->data, pos);
        free(t);
        return;
    }

    for (i = 1; i < pos && t != NULL; i++) {
        prev = t;
        t = t->next;
    }

    if (t == NULL) {
        printf("Invalid position %d.\n", pos);
        return;
    }

    prev->next = t->next;
    printf("Deleted %d from position %d.\n", t->data, pos);
    free(t);
}

// Display the linked list
void display() {
    list *t = start;
    if (t == NULL) {
        printf("List is empty.\n");
        return;
    }
    printf("Linked List: ");
    while (t != NULL) {
        printf("%d -> ", t->data);
        t = t->next;
    }
    printf("NULL\n");
}

// Count number of nodes
void count_nodes() {
    int count = 0;
    list *t = start;
    while (t != NULL) {
        count++;
        t = t->next;
    }
    printf("Total nodes: %d\n", count);
}

// Main menu
int main() {
    int choice, val, pos;
    while (1) {
        printf("\n--- Single Linked List Menu ---\n");
        printf("1. Create List\n");
        printf("2. Insert at Beginning\n");
        printf("3. Insert at End\n");
        printf("4. Insert at Specific Position\n");
        printf("5. Delete from Beginning\n");
        printf("6. Delete from End\n");
        printf("7. Delete from Specific Position\n");
        printf("8. Display List\n");
        printf("9. Count Nodes\n");
        printf("10. Exit\n");
        printf("Enter choice: ");
        scanf("%d", &choice);

        switch (choice) {
        case 1:
            create();
            break;
        case 2:
            printf("Enter value: ");
            scanf("%d", &val);
            insert_begin(val);
            break;
        case 3:
            printf("Enter value: ");
            scanf("%d", &val);
            insert_end(val);
            break;
        case 4:
            printf("Enter value: ");
            scanf("%d", &val);
            printf("Enter position: ");
            scanf("%d", &pos);
            insert_position(val, pos);
            break;
        case 5:
            delete_begin();
            break;
        case 6:
            delete_end();
            break;
        case 7:
            printf("Enter position to delete: ");
            scanf("%d", &pos);
            delete_position(pos);
            break;
        case 8:
            display();
            break;
        case 9:
            count_nodes();
            break;
        case 10:
            exit(0);
        default:
            printf("Invalid choice!\n");
        }
    }
    return 0;
}
